<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Trading Dashboard</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { background:#0b0f19; color:white; font-family:Arial; padding:20px; }
    .card { border:1px solid #444; border-radius:12px; padding:15px; margin:10px 0; }
    .symbol { font-size:24px; }
    .price { font-size:32px; font-weight:bold; }
    .green { color:#22c55e; }
    .red { color:#ef4444; }
  </style>
</head>
<body>

<h1>Stark Trading Dashboard</h1>
<p>Données temps réel via Render + yFinance</p>

<div id="container"></div>

<script>
const API = "https://trading-dashboard-d3ao.onrender.com/latest";

const SYMBOLS = ["ES", "NQ", "BTC", "CL", "GC"];
const container = document.getElementById("container");

async function fetchSymbol(sym) {
  try {
    const res = await fetch(API + "?symbol=" + sym);
    return await res.json();
  } catch(e) {
    return { error: true };
  }
}

function renderCard(data) {
  if (data.error) {
    return `
      <div class="card">
        <div class="symbol">Erreur</div>
        <div class="price red">Impossible de charger</div>
      </div>`;
  }

  const color = data.change_pct >= 0 ? "green" : "red";

  return `
    <div class="card">
      <div class="symbol">${data.symbol}</div>
      <div class="price">${data.price.toLocaleString("fr-FR", {minimumFractionDigits:2})}</div>
      <div class="${color}">${data.change_pct}%</div>
    </div>`;
}

async function update() {
  container.innerHTML = "";
  for (const sym of SYMBOLS) {
    const data = await fetchSymbol(sym);
    container.innerHTML += renderCard(data);
  }
}

update();
setInterval(update, 15000);
</script>

</body>
</html>
